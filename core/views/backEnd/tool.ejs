<div ng-controller="textsCtrl" ng-cloak>
    <div class="page-title">
        <div class="title_left">
            <h3>
                Herramienta de textos
            </h3>
        </div>
    </div>
    <div class="clearfix"></div>
    <div ng-cloak class="row ">
        <div ng-cloak ng-show="showForm==1" class="col-xs-12">
            <!--<% if (!production) { %>-->
            <!--<button ng-click="clickShowForm(2)" type="button" class="btn btn-success btn-sm pull-left"-->
                    <!--style="margin-left: 10px">-->
                <!--<i class="fa fa-plus"></i> Nuevo Texto-->
            <!--</button>-->
            <!--<% } %>-->
            <div class="clearfix"></div>

            <div class="x_content">

                <div class="col-xs-3">
                    <!-- required for floating -->
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs tabs-left">
                        <li class="active"><a href="#home" data-toggle="tab" aria-expanded="true">General</a>
                        </li>
                        <li class=""><a href="#profile" data-toggle="tab" aria-expanded="false">Páginas</a>
                        </li>
                        <li class=""><a href="#messages" data-toggle="tab" aria-expanded="false">Nombres para Urls</a>
                        </li>
                    </ul>
                </div>

                <div class="col-xs-9">
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div class="tab-pane active" id="home">
                            <div class="table-responsive">
                                <table  class="table table-condensed table-striped table-bordered jambo_table bulk_action">
                                    <thead>
                                    <tr class="headings">
                                        <th class="column-title">Elementos</th>
                                        <th class="column-title"># Componentes</th>
                                        <th class="column-title no-link last" style="min-width: 124px;"><span
                                                    class="nobr">Acción</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-cloak class="even " ng-repeat="text in texts" ng-show="isGeneral(text)">
                                        <td class=" ">{{NameGeneral(text)}}</td>
                                        <td class=" ">{{text.components.length}}</td>
                                        <td class="td-button-padding">
                                            <button type="button" ng-click="selectForEdit(text)" class="btn btn-success btn-xs">
                                                <i class="fa fa-edit"></i>
                                            </button>
                                            <!--<button type="button" ng-click="selectViewPhotos(text)"
                                                    class="btn btn-warning btn-xs">
                                                <i class="fa fa-photo"></i>
                                            </button>-->

                                            <% if (!production) { %>

                                            <button ng-click="selectForRemove(text)" data-toggle="modal" data-target=".remove-page"
                                                    type="button" class="btn btn-danger btn-xs"><i
                                                        class="fa fa-trash-o"></i>
                                            </button>
                                            <% } %>

                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane" id="profile">
                            <div class="table-responsive">
                                <table class="table table-condensed table-striped table-bordered jambo_table bulk_action">
                                    <thead>
                                    <tr class="headings">
                                        <th class="column-title">Página</th>
                                        <th class="column-title"># Componentes</th>
                                        <th class="column-title no-link last" style="min-width: 124px;"><span
                                                    class="nobr">Acción</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-cloak class="even " ng-repeat="text in texts" ng-show="isPage(text)">
                                        <td class=" ">{{NamePage(text)}}</td>
                                        <td class=" ">{{text.components.length}}</td>
                                        <td class="td-button-padding">
                                            <button type="button" ng-click="selectForEdit(text)" class="btn btn-success btn-xs">
                                                <i class="fa fa-edit"></i>
                                            </button>
                                            <!--<button type="button" ng-click="selectViewPhotos(text)"
                                                    class="btn btn-warning btn-xs">
                                                <i class="fa fa-photo"></i>
                                            </button>-->

                                            <% if (!production) { %>

                                            <button ng-click="selectForRemove(text)" data-toggle="modal" data-target=".remove-page"
                                                    type="button" class="btn btn-danger btn-xs"><i
                                                        class="fa fa-trash-o"></i>
                                            </button>
                                            <% } %>

                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane" id="messages">
                            <div class="table-responsive">
                                <table class="table table-condensed table-striped table-bordered jambo_table bulk_action">
                                    <thead>
                                    <tr class="headings">
                                        <th class="column-title">Página</th>
                                        <th class="column-title"># Componentes</th>
                                        <th class="column-title no-link last" style="min-width: 124px;"><span
                                                    class="nobr">Acción</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-cloak class="even " ng-repeat="text in texts" ng-show="isSlug(text)">
                                        <td class=" ">Lista de Urls</td>
                                        <td class=" ">{{text.components.length}}</td>
                                        <td class="td-button-padding">
                                            <button type="button" ng-click="selectForEdit(text)" class="btn btn-success btn-xs">
                                                <i class="fa fa-edit"></i>
                                            </button>
                                            <!--<button type="button" ng-click="selectViewPhotos(text)"
                                                    class="btn btn-warning btn-xs">
                                                <i class="fa fa-photo"></i>
                                            </button>-->

                                            <% if (!production) { %>

                                            <button ng-click="selectForRemove(text)" data-toggle="modal" data-target=".remove-page"
                                                    type="button" class="btn btn-danger btn-xs"><i
                                                        class="fa fa-trash-o"></i>
                                            </button>
                                            <% } %>

                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="clearfix"></div>

            </div>
            <!--<div class="col-md-6 col-xs-12">-->
                <!--<div class="clearfix"></div>-->
                <!--<div class="table-responsive">-->
                    <!--<table id="example" class="table table-striped responsive-utilities jambo_table">-->
                        <!--<thead>-->
                        <!--<tr class="headings">-->
                            <!--<th class="column-title">Grupo</th>-->
                            <!--<th class="column-title"># Componentes</th>-->
                            <!--<th class="column-title"># Fotos</th>-->
                            <!--<th class="column-title no-link last" style="min-width: 124px;"><span-->
                                        <!--class="nobr">Acción</span>-->
                            <!--</th>-->
                        <!--</tr>-->
                        <!--</thead>-->
                        <!--<tbody>-->
                        <!--<tr ng-cloak class="even" ng-repeat="text in texts" ng-hide="isPage(text) || isGeneral(text)">-->
                            <!--<td class=" ">{{text.group}}</td>-->
                            <!--<td class=" ">{{text.components.length}}</td>-->
                            <!--<td class=" ">{{text.photos.length}}</td>-->
                            <!--<td class="td-button-padding">-->
                                <!--<button type="button" ng-click="selectForEdit(text)" class="btn btn-success btn-xs">-->
                                    <!--<i class="fa fa-edit"></i>-->
                                <!--</button>-->
                                <!--&lt;!&ndash;<button type="button" ng-click="selectViewPhotos(text)"-->
                                        <!--class="btn btn-warning btn-xs">-->
                                    <!--<i class="fa fa-photo"></i>-->
                                <!--</button>&ndash;&gt;-->

                                <!--<% if (!production) { %>-->

                                <!--<button ng-click="selectForRemove(text)" data-toggle="modal" data-target=".remove-page"-->
                                        <!--type="button" class="btn btn-danger btn-xs"><i-->
                                            <!--class="fa fa-trash-o"></i>-->
                                <!--</button>-->
                                <!--<% } %>-->

                            <!--</td>-->
                        <!--</tr>-->
                        <!--</tbody>-->
                    <!--</table>-->
                <!--</div>-->
                <!--<uib-pagination direction-links="false" boundary-links="true" total-items="totalItems"-->
                                <!--ng-model="currentPage" max-size="maxSize"-->
                                <!--class="pagination pagination-sm no-margin pull-right " ng-change="pageChanged()"-->
                                <!--previous-text="&lsaquo;"-->
                                <!--next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;">-->
                <!--</uib-pagination>-->
            <!--</div>-->



            <!--<div class="col-md-6 col-xs-12">-->
                <!--<div class="alert alert-info alert-dismissible fade in active" role="alert" style="margin-top: 70px;">-->
                    <!--<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span-->
                                <!--aria-hidden="true">×</span>-->
                    <!--</button>-->
                    <!--<i class="fa fa-lightbulb-o"></i> Esta herramienta, ayuda a definir los textos necesarios para-->
                    <!--un completo cambio de idioma:<br>-->

                <!--</div>-->
            <!--</div>-->

        </div>
        <div ng-cloak ng-show="showForm==2" class="col-xs-12" style="text-align:center;">

            <div ng-hide="viewPhotos" class="col-xs-12">
                <div class="x_title no-margin-bottom no-padding-bottom">
                    <h2 class="text-left">Construcción
                        <small>utiliza diferentes componentes</small>
                    </h2>
                    <button ng-click="clickShowForm(1)" type="button" class="btn btn-primary btn-sm pull-right">
                        <i class="fa fa-arrow-left"></i> Ir Atrás
                    </button>
                    <div class="clearfix"></div>
                </div>
                <form id="text-form" class="form-horizontal form-label-left">
                    <div class="col-md-5 col-xs-12">
                        <div class="form-group text-left">
                            <label class="control-label col-md-6 col-xs-12 text-left">
                                Nombre del Grupo <span class="required">*</span>
                            </label>

                            <div class="col-md-6 col-xs-12">
                                <input type="text" ng-model="text.group" required="required"
                                        <% if (production) { %>
                                       disabled
                                        <% } %>
                                       class="form-control col-md-7 col-xs-12">
                            </div>
                        </div>
                        <div class="col-xs-12 limit_scroller">
                            <div class="input-group col-xs-4 pull-right">
                                <input type="text" class="form-control input-sm" ng-model="searchText"
                                       placeholder="filtrar...">
                            </div>
                            <div class="clearfix"></div>
                            <div class="table-responsive" style="max-height: 400px;overflow: auto">
                                <table id="example" class="table table-condensed table-striped table-bordered jambo_table bulk_action">
                                    <thead>
                                    <tr class="headings">
                                        <th class="column-title col-xs-2" style="text-align: center">#</th>
                                        <th class="column-title">Identificador</th>
                                        <th class="column-title no-link last col-xs-3" style="text-align: center"><span
                                                    class="nobr">Acción</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-cloak class="even" ng-click="editCmp(cmp)"
                                        ng-repeat="cmp in text.components | filter:searchText">
                                        <td class="">{{$index+1}}</td>
                                        <td style="text-align: left">{{cmp.id}}</td>
                                        <td class=" ">
                                            <button type="button" ng-click="editCmp(cmp)"
                                                    class="btn btn-success btn-xs">
                                                <i class="fa fa-edit"></i>
                                            </button>

                                            <% if (!production) { %>
                                            <button ng-click="delCmp($index)" type="button"
                                                    class="btn btn-danger btn-xs"><i
                                                        class="fa fa-trash-o"></i>
                                            </button>
                                            <% } %>

                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-7 col-xs-12">
                        <div class="col-xs-12">
                            <% if (!production) { %>
                            <button type="button" class="btn btn-default" ng-click="initializeText()"><i
                                        class="fa fa-plus"></i> Campo de Texto
                            </button>
                            <button type="button" class="btn btn-default" ng-click="initializeParagraph()"><i
                                        class="fa fa-plus"></i> Área de Texto
                            </button>
                            <% } %>

                        </div>

                        <div ng-show="showFormCmp" class="x_panel" id="componentForm">
                            <label class="col-xs-12" style="text-align: left">
                                Identificador <span class="required">*</span>
                            </label>

                            <div class="col-xs-12 center-margin">
                                <input type="text" ng-model="cmpTxt.id" required="required"
                                        <% if (production) { %>
                                       disabled
                                        <% } %>
                                       class="form-control col-md-7 col-xs-12">
                            </div>

                            <div class="clearfix"></div>
                            <div class="" style="margin-top: 30px;">
                                <div>

                                    <ul id="myTabLaguage" class="nav nav-tabs bar_tabs" role="tablist"
                                        style="width: auto">
                                        <li ng-repeat="lang in $root.M_LANGUAGES" role="presentation"
                                            ng-class="{'active':$index == selectTab}" ng-click="selectedTab($index)">
                                            <a id="home-tab" role="tab" data-toggle="tab" aria-expanded="false">{{lang.name}}</a>
                                        </li>
                                    </ul>


                                    <div class="clearfix"></div>

                                    <div id="myTabContentInfo" class="tab-content">
                                        <div ng-repeat="lang in $root.M_LANGUAGES" role="tabpanel" class="tab-pane fade"
                                             ng-class="{active:$index==selectTab,in:$index==selectTab}"
                                             aria-labelledby="home-tab">

                                            <div ng-cloak class="form-group col-xs-12">
                                                <!--<div class="col-xs-12">-->
                                                <!--<div class="form-group">-->
                                                <label class="col-xs-12" style="text-align: left">
                                                    Valor
                                                    <span class="required">*</span>
                                                </label>

                                                <div ng-show="cmpTxt.type=='paragraph'" class="col-xs-12">
                                                    <textarea ui-tinymce="tinymceOptions"
                                                              ng-model="cmpTxt.paragraph[$index].value"></textarea>

                                                    <div class="clearfix"></div>

                                                </div>

                                                <div ng-show="cmpTxt.type=='text'" class="col-xs-12">
                                                    <input type="text" required="required"
                                                           class="form-control col-md-7 col-xs-12 input-sm"
                                                           ng-model="cmpTxt.text[$index].value">
                                                </div>

                                                <div class="clearfix"></div>
                                                <div class="col-xs-12" style="margin-top: 10px">
                                                    <button ng-show="!showEditButton" class="btn btn-success pull-right"
                                                            ng-disabled="!validateFormCmp()" ng-click="addCmp()">Crear
                                                    </button>

                                                    <button ng-show="showEditButton" class="btn btn-success pull-right"
                                                            ng-disabled="!validateFormCmp()" ng-click="saveCmp()">
                                                        Guardar
                                                    </button>

                                                    <button class="btn btn-primary pull-right"
                                                            ng-click="cancelFormCmp()">
                                                        Cancelar
                                                    </button>
                                                </div>
                                                <!--</div>-->
                                                <!--</div>-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-show="!showFormCmp">
                            <div class="col-xs-12">
                                <div class="alert alert-info fade in active" role="alert" style="margin-top: 40px;">
                                    </button>
                                    <i class="fa fa-lightbulb-o"></i> El identificador es una variable que se utiliza
                                    para
                                    empotrar los textos internacionalizados en la aplicación<br>

                                </div>
                            </div>
                        </div>
                        <div ng-show="!showFormCmp">
                            <div class="clearfix"></div>
                            <div class="ln_solid"></div>
                            <div class="form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">

                                    <button ng-disabled="!validateForm()" ng-show="!showUpdate" ng-click="create()"
                                            type="button" class="btn btn-success">
                                        Crear
                                    </button>
                                    <button ng-disabled="!validateForm()" ng-show="showUpdate" ng-click="update()"
                                            type="button" class="btn btn-success">
                                        Guardar
                                    </button>
                                    <button ng-click="clickShowForm(1)" type="button" class="btn btn-primary">Cancelar
                                    </button>

                                </div>
                            </div>
                        </div>
                    </div>


                </form>
            </div>
            <div ng-show="viewPhotos" class="col-xs-12">
                <div class="x_title">
                    <h2><i class="fa fa-photo"></i> Fotos
                    </h2>
                    <button ng-click="clickShowForm(1)" type="button" class="btn btn-primary btn-sm pull-right">
                        <i class="fa fa-arrow-left"></i> Ir Atrás
                    </button>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="row">

                        <% if (!production) { %>
                        <button type="button" data-toggle="modal" data-target=".avatar-modal"
                                class="btn btn-success btn-sm pull-right">
                            <i class="fa fa-plus"></i> Nueva Foto
                        </button>
                        <% } %>

                        <div class="clearfix"></div>
                        <div ng-cloak class="col-md-55" ng-repeat="photo in text.photos">
                            <div class="thumbnail ui-ribbon-container">
                                <div ng-cloak class="image view view-first">
                                    <img style="width: 100%;height: 120px !important; display: block;"
                                         ng-src="{{'/service/media/'+ photo.media}}" alt="image">

                                    <div class="mask">
                                        <p>{{ photo.id}}</p>

                                        <div class="tools tools-bottom">
                                            <a href="#" ng-click="selectPhotos(photo)" data-toggle="modal"
                                               data-target=".photo-preview"><i
                                                        class="fa fa-search"></i></a>

                                            <a href="#" ng-click="delPhotos(photo)"><i
                                                        class="fa fa-trash"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
        <div class="clearfix"></div>
    </div>
    <div ng-cloak class="modal fade remove-page" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true"><i class="fa fa-close"></i></span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel2">Eliminar Texto</h4>
                </div>
                <div class="modal-body">
                    <h4> {{text.group}}</h4>
                    Desea eliminar el Texto seleccionado?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="remove()">
                        Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade photo-preview" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true"><i class="fa fa-close"></i></span>
                    </button>
                    <div class="clearfix"></div>
                </div>
                <div class="modal-body">
                    <div class="col-xs-12">
                        <img class="avatar-view" style="margin: 0 auto;width: 550px;height: 230px;cursor: default"
                             ng-src="{{picture}}"/>
                    </div>
                </div>
                <br>

                <div class="clearfix"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        Cancelar
                    </button>
                </div>

            </div>
        </div>
    </div>
    <div class="modal fade avatar-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span
                                aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">Seleccionar Avatar</h4>
                </div>
                <div class="modal-body">
                    <div>
                        <div ng-show="imageCropStep == 1">
                            <br/>
                            <input type="file" name="fileInput" id="fileInput"
                                   onchange="angular.element(this).scope().fileChanged(event)"/>
                        </div>

                        <div class="col-xs-12" ng-show="imageCropStep == 2" style="box-shadow: inset 0 0 1em #34495E;">
                            <!-- <image-crop
                               data-height="200" //shape's height
                               data-width="150" //shape's width
                               data-shape="square" //the shape.. square or circle
                               data-step="imageCropStep"//scope variable that will contain the current step of the crop (1. Waiting for source image; 2. Image loaded, waiting for crop; 3. Crop done)
                               src="imgSrc" //scope variable that will be the source image for the crop (may be a Blob or base64 string)
                               data-result-blob="result" //scope variable that will contain the Blob information
                               data-result="resultDataUrl" //scope variable that will contain the image's base64 string representation
                               crop="initCrop" //scope variable that must be set to true when the image is ready to be cropped
                               padding="250" //space, in pixels, rounding the shape
                               max-size="1024" //max of the image, in pixels
                             ></image-crop> -->

                            <image-crop data-height="230" data-width="550" data-shape="square" data-step="imageCropStep"
                                        src="imgSrc" data-result="result"
                                        data-result-blob="resultBlob" crop="initCrop" padding="200"
                                        max-size="1024"></image-crop>
                        </div>

                        <div class="col-xs-12">
                            <div ng-show="imageCropStep == 2">
                                <br/>
                                <button ng-click="clear()" class="btn btn-default input-sm pull-left">Volver a
                                    Seleccionar
                                </button>
                                <button ng-click="initCrop = true" class="btn btn-success input-sm pull-right">Cortar
                                    Imagen
                                </button>
                            </div>

                            <div ng-show="imageCropStep == 3">
                                <div class="clearfix"></div>
                                <img class="avatar-view" style="margin: 0 auto;width: 550px;height:230px "
                                     ng-src="{{result}}"/>

                                <div class="col-xs-12">
                                    <p>Identificador<span class="required">*</span></p>

                                    <div class="col-xs-12">
                                        <input type="text" id="first-name" required="required" ng-model="identification"
                                               class="form-control col-md-7 col-xs-12">
                                    </div>
                                </div>
                                <div class="clearfix"></div>

                                <div class="ln_solid"></div>
                                <div class="col-xs-12">

                                    <button ng-click="addPhotos()" type="button" ng-disabled="!identification.length"
                                            data-dismiss="modal" class="btn btn-success input-sm pull-right">
                                        Guardar Cambios
                                    </button>
                                    <button ng-click="clear()" type="button" class="btn btn-default input-sm pull-left">
                                        Volver a Seleccionar
                                    </button>
                                </div>


                            </div>
                        </div>
                        <div class="clearfix"></div>


                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        Cancelar
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>